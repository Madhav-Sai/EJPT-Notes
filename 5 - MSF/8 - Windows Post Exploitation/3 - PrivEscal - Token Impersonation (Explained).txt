## Access Token Impersonation

- *Access* : Managed by LSASS (Local Security Authority Service)
- *Access Token* : responsible for identifying and describing the security context of a process or thread running on a system.
- *Access Token generation* : are generated by winlogon.exe process every time a user authenticates successfully and includes the identity and privilges of the user account associated with the thread or process.
- *Access Token Child* : This token is then attach to userinit.exe process after which all child prrocesses started bu a user will inherit a copy of the access token from their creator and run under the privileges of the same access token

---

- An access token will typically be assigned one of the following security levels:

> - *Impersonate-level tokens* are created as a direct result of a non-interactive login on Windows, typically through specific system services or domain logons.

> - *Delegate-level tokens* are typically created through an interactive login on Windows, primarily through a traditional login or through remote access protocols such as RDP.

---

The following are the privileges that are required for a successful impersonation attack :

> - *SeAssignPrimaryToken*: This allows a user to impersonate tokens.
> - *SeCreateToken*: This allows a user to create an arbitrary token with administrative privileges.
> - *SeImpersonatePrivilege*: This allows a user to create a process under the security context of another user typically with dministrative privileges.
